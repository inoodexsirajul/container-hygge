import{c as U,J as E,O as L,E as Y,P as G,r as J,y as x,j as e,Q as z,N as Q}from"./app-BTVdD3YE.js";const H=()=>{var u,b,j,N,p,v,f,y,w,k,C;const o=U(),m=E(),R=localStorage.getItem("authToken"),{data:a,isLoading:h,error:c}=L(void 0,{refetchOnMountOrArgChange:!0}),[F]=Y(),[O]=G();J.useEffect(()=>{var s;(c==null?void 0:c.status)===401?(localStorage.removeItem("authToken"),o("/signin")):c&&x.error(((s=c==null?void 0:c.data)==null?void 0:s.message)||"Failed to load cart")},[c,o]);const A=(s,t,d)=>{const r=Number(t)||0,l=Number(d)||0;if(r>=l){x.warn(`Only ${l} item(s) available in stock`);return}g(s,r+1)},D=(s,t)=>{const d=Number(t)||0;d<=1||g(s,d-1)},g=async(s,t)=>{var l;const d=Number(t);if(isNaN(d)||d<1)return;const r=m(Q.util.updateQueryData("getCartSummery",void 0,n=>{const i=n.data.cart_items.find(_=>_.id===s);i&&(i.quantity=t)}));try{await O({id:s,quantity:t}).unwrap()}catch(n){r.undo(),x.error(((l=n==null?void 0:n.data)==null?void 0:l.message)||"Update failed")}},T=async s=>{const t=m(Q.util.updateQueryData("getCartSummery",void 0,d=>{d.data.cart_items=d.data.cart_items.filter(r=>r.id!==s)}));try{await F(s).unwrap()}catch{t.undo()}};return h?e.jsx("div",{className:"min-h-screen py-8 px-5 2xl:px-20 bg-dark1 animate-pulse",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"h-10 bg-dark2 rounded-lg w-64 mb-8"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray/30",children:e.jsx("div",{className:"h-7 bg-dark3 rounded w-48"})}),e.jsx("div",{className:"divide-y divide-gray/30",children:[1,2,3].map(s=>e.jsxs("div",{className:"p-6 flex flex-col sm:flex-row items-start sm:items-center gap-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-24 h-24 bg-dark3 rounded-lg"}),e.jsx("div",{className:"w-24 h-24 bg-dark3 rounded-lg hidden sm:block"})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-6 bg-dark3 rounded w-3/4"}),e.jsx("div",{className:"h-5 bg-dark3 rounded w-24"}),e.jsx("div",{className:"h-5 bg-dark3 rounded w-32"}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-8 h-8 bg-dark3 rounded-l-md"}),e.jsx("div",{className:"w-12 h-8 bg-dark3"}),e.jsx("div",{className:"w-8 h-8 bg-dark3 rounded-r-md"})]}),e.jsx("div",{className:"w-8 h-8 bg-dark3 rounded"})]})]}),e.jsx("div",{className:"h-8 bg-dark3 rounded w-20"})]},s))})]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md sticky top-8",children:[e.jsx("div",{className:"p-6 border-b border-gray/30",children:e.jsx("div",{className:"h-7 bg-dark3 rounded w-40"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-5 bg-dark3 rounded w-20"}),e.jsx("div",{className:"h-5 bg-dark3 rounded w-24"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-5 bg-dark3 rounded w-20"}),e.jsx("div",{className:"h-5 bg-dark3 rounded w-24"})]}),e.jsx("div",{className:"pt-4 border-t border-gray/30",children:e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("div",{className:"h-6 bg-dark3 rounded w-16"}),e.jsx("div",{className:"h-7 bg-dark3 rounded w-28"})]})}),e.jsx("div",{className:"h-12 bg-green-800/50 rounded-lg"})]})]})})]})]})}):e.jsx("div",{className:"min-h-screen py-8  bg-dark1",children:e.jsx("div",{className:"max-w-[1200px] mx-auto px-4 2xl:px-20",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-xl md:text-3xl md:font-bold text-cream mb-8",children:"Your Shopping Cart"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray/30",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray",children:["Cart Items (",((b=(u=a==null?void 0:a.data)==null?void 0:u.cart_items)==null?void 0:b.length)||0,")"]})}),e.jsx("div",{className:"divide-y divide-gray/30",children:((N=(j=a==null?void 0:a.data)==null?void 0:j.cart_items)==null?void 0:N.length)===0?e.jsx("div",{className:"p-6 text-center text-gray",children:"Your cart is empty"}):(v=(p=a==null?void 0:a.data)==null?void 0:p.cart_items)==null?void 0:v.map(s=>{var $,M,I;const t=P=>P&&P.trim()!=="",d=t(($=s.product)==null?void 0:$.thumb_image)?`/${s.product.thumb_image}`:null,r=t(s==null?void 0:s.front_image)?`/${s.front_image}`:null,l=t(s==null?void 0:s.back_image)?`/${s.back_image}`:null,n=d||r||l,i=((M=s.product)==null?void 0:M.qty)||0,q=(s.quantity||1)>=i;return console.log(s),e.jsxs("div",{className:"p-6 flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[d&&e.jsx("img",{src:d,alt:"",className:"w-24 h-24 object-cover rounded-lg"}),r&&e.jsx("img",{src:r,alt:"",className:"w-24 h-24 object-contain rounded-lg"}),l&&e.jsx("img",{src:l,alt:"",className:"w-24 h-24 object-cover rounded-lg"}),!n&&e.jsx("div",{className:"w-24 h-24 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"No Image"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-cream",children:(I=s==null?void 0:s.product)==null?void 0:I.name}),e.jsxs("p",{className:"text-sm md:text-lg font-bold text-gray mt-1",children:["$",Number(s.price)]}),e.jsxs("p",{className:"text-sm font-bold text-gray mt-1",children:["Extra Price $",Number(s.extra_price)]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>D(s.id,s.quantity),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded-l-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:s.quantity<=1,children:"âˆ’"}),e.jsx("span",{className:"w-12 h-8 flex items-center justify-center bg-gray-100 font-medium",children:s.quantity}),e.jsx("button",{onClick:()=>A(s.id,s.quantity,i),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded-r-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:q,children:"+"})]}),q&&e.jsxs("p",{className:"text-yellow-500 text-xs",children:["Max available:"," ",i]}),e.jsx("button",{onClick:()=>T(s.id),className:"text-red-600 hover:text-red-700 cursor-pointer",children:e.jsx(z,{})})]})]}),e.jsx("div",{className:"mt-2 sm:mt-0",children:e.jsxs("p",{className:"text-lg font-bold text-cream",children:["$",Number(s.price)*s.quantity]})})]},s.id)})})]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"bg-dark2 rounded-lg shadow-md sticky top-8",children:[e.jsx("div",{className:"p-6 border-b border-gray/30",children:e.jsx("h2",{className:"text-xl font-semibold text-cream",children:"Order Summary"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-cream",children:"Subtotal"}),e.jsxs("span",{className:"font-medium text-cream",children:["$",((f=a==null?void 0:a.data)==null?void 0:f.sub_total)||0]})]}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("span",{className:"text-cream",children:"Discount"}),e.jsxs("span",{className:"font-medium text-green-600",children:["-$",Number(((y=a==null?void 0:a.data)==null?void 0:y.discount)||0)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold mb-6 pt-4 border-t border-gray/30",children:[e.jsx("span",{className:"text-cream",children:"Total"}),e.jsxs("span",{className:"text-cream",children:["$",((w=a==null?void 0:a.data)==null?void 0:w.sub_total)||0]})]}),e.jsx("button",{onClick:()=>{if(R)o("/checkout");else{const s=window.location.pathname;o(`/signin?redirect=${encodeURIComponent(s)}`),x.warn("Please login to continue shopping!",{position:"top-center"})}},className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 transition-colors",disabled:h||(((C=(k=a==null?void 0:a.data)==null?void 0:k.cart_items)==null?void 0:C.length)||0)===0,children:"Proceed to Checkout"})]})]})})]})]})})})};export{H as default};
